DIRICHLET = 0
NEUMANN   = 1
PERIODIC  = 2
MIXED     = 3
ROBIN     = 4

pflotran_filename="pflotran.15c.4320p.in"

CartesianGeometry{
   domain_boxes = [(0,0,0), (19,19,79)]
   x_lo         = 0.0e0, 0.0e0, 0.0e0  
   x_up         = 20.0e0, 20.0e0, 80.0e0
}


GriddingAlgorithm{
   max_levels = 2 
   largest_patch_size {
      level_0 = 20, 20, 80
      level_1 = 40, 40, 40
   }
 smallest_patch_size {
      level_0 = 10,10,40
      level_1 = 5,5,10
   }
   ratio_to_coarser {
      level_1  = 2, 2, 2
   }
   combine_efficiency = 0.95
   efficiency_tolerance = 0.95
   coalesce_boxes=FALSE
   check_nonrefined_tags='i'
}

StandardTagAndInitialize{
   tagging_method = "REFINE_BOXES"
   RefineBoxes{
      level_0 = [(0,0,0),(19,19,19)]
      level_1 = [(0,0,0),(39,39,19)]
      level_2 = [(0,0,0),(79,79,19)]
      level_3 = [(0,0,0),(159,159,19)]
      level_4 = [(0,0,0),(319,319,19)]
      level_5 = [(0,0,0),(639,639,19)]
   }
}

LoadBalancer{
   bin_pack = "SPATIAL"
}

PflotranApplicationStrategy{
   DriverMode                       = 1
   nl_tangential_coarse_fine_scheme = "LINEAR"
   nl_normal_coarse_fine_scheme     = "LINEAR"
   number_of_modes       = 3

   PflotranFlowMultilevelOperator{
     	       operator_name                   = "PflotranMultilevelOperator"
	       tangent_interp_scheme           = "LINEAR"
	       normal_interp_scheme            = "LINEAR"
	       adjust_cf_coefficients          = FALSE
	       interpolate_ghost_values        = TRUE
	       extrapolation_order             = 2
	       boundary_conditions             = NEUMANN, NEUMANN, NEUMANN, NEUMANN, NEUMANN, DIRICHLET
	       coarsen_diffusive_fluxes        = TRUE
	       coarsen_convective_fluxes       = TRUE
	       print_info_level                = 0
	       cell_refine_op                  = "CONSTANT_REFINE"
	       cell_coarsen_op                 = "CONSERVATIVE_COARSEN"
	       cell_soln_coarsen_op                 = "CONSERVATIVE_COARSEN"
	       cell_src_coarsen_op                 = "SUM_COARSEN"
	       face_refine_op                  = "CONSTANT_REFINE"
	       face_coarsen_op                 = "CONSERVATIVE_COARSEN"
	       variable_order_interpolation    = FALSE
	       use_cf_interpolant              = TRUE
   }
   PflotranTransportMultilevelOperator{
     	       operator_name                   = "PflotranMultilevelOperator"
	       tangent_interp_scheme           = "LINEAR"
	       normal_interp_scheme            = "LINEAR"
	       adjust_cf_coefficients          = FALSE
	       interpolate_ghost_values        = TRUE
	       extrapolation_order             = 2
	       boundary_conditions             = NEUMANN, NEUMANN, NEUMANN, NEUMANN, NEUMANN, DIRICHLET
	       coarsen_diffusive_fluxes        = TRUE
	       coarsen_convective_fluxes       = TRUE
	       print_info_level                = 0
	       cell_refine_op                  = "CONSTANT_REFINE"
	       cell_coarsen_op                 = "CONSERVATIVE_COARSEN"
	       cell_soln_coarsen_op                 = "CONSERVATIVE_COARSEN"
	       cell_src_coarsen_op                 = "SUM_COARSEN"
	       face_refine_op                  = "CONSTANT_REFINE"
	       face_coarsen_op                 = "CONSERVATIVE_COARSEN"
	       variable_order_interpolation    = FALSE
	       use_cf_interpolant              = TRUE
   }

   PflotranFlowPreconditioner{

     preconditioner_print_flag = FALSE

     pc_solver{
       solver_name                      =  "FAC"
       max_iterations                   =  1 
       max_error                        =  1.0e-12
       print_info_level                 =  1 
       presolve_iterations              =  2
       postsolve_iterations             =  2
       use_visit                        =  FALSE
       viz_directory                    =  "fac_viz"
       zero_initial_guess               =  TRUE

       level_solver_0 {
            solver_name                = "CellHYPRELevelSolver"
            print_info_level           = 0 
            mg_solver_type             = 1
            max_iterations             = 1
            max_error                  = 1.0e-12
            num_presweeps              = 2
            num_postsweeps             = 2
            preprocess_rhs             = FALSE
       }

       level_solver_1 {
            solver_name                 =  "CellLevelSmoother"
            smoother_type               =  "Red-black Gauss-Seidel"
            print_info_level            =  0 
            max_iterations              =  1
            max_error                   =  1.0e-12
            num_sweeps                  =  10
       }
     }
        
   }
   PflotranTransportPreconditioner{

     preconditioner_print_flag = FALSE

     pc_solver{
       solver_name                      =  "FAC"
       max_iterations                   =  2 
       max_error                        =  1.0e-12
       print_info_level                 =  1 
       presolve_iterations              =  2
       postsolve_iterations             =  2
       use_visit                        =  FALSE
       viz_directory                    =  "fac_viz"
       zero_initial_guess               =  TRUE

       level_solver_0 {
            solver_name                = "CellHYPRELevelSolver"
            print_info_level           = 0 
            mg_solver_type             = 1
            max_iterations             = 1
            max_error                  = 1.0e-12
            num_presweeps              = 2
            num_postsweeps             = 2
            preprocess_rhs             = FALSE
       }

       level_solver_1 {
            solver_name                 =  "CellLevelSmoother"
            smoother_type               =  "Red-black Gauss-Seidel"
            print_info_level            =  0 
            max_iterations              =  1
            max_error                   =  1.0e-12
            num_sweeps                  =  10
       }
     }
        
   }

}


TimerManager{
   timer_list = "xfer::*::*", "FAC::*::*", "AMRUtilities::*::*", "apps::main::main", "PFlotran::*::*", "LevelSolver::*::*"
}


