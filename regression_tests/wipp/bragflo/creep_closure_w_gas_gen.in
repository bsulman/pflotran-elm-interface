! 9.6 Test Case #6-b. Creep Closure.
! The whole domain generates gas (from wastes) while creep closure occurs
! For more descriptions of the problem please read case_6-b.docx

!======== flow mode ========

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE GENERAL
      OPTIONS
        TWO_PHASE_ENERGY_DOF TEMPERATURE
        GAS_COMPONENT_FORMULA_WEIGHT 2.01588d0 ! kg/kmol
        MAXIMUM_PRESSURE_CHANGE 5e5
	TOUGH2_ITOL_SCALED_RESIDUAL 1.d-5
        ISOTHERMAL
      /
    /
  /
END

SUBSURFACE

REGRESSION
  CELLS
    1
    7
    15
    3
    13
  /
END

FLUID_PROPERTY
  PHASE LIQUID
  DIFFUSION_COEFFICIENT 0.0d0
END

FLUID_PROPERTY
  PHASE GAS
  DIFFUSION_COEFFICIENT 0.0d0
END

EOS WATER
  DENSITY EXPONENTIAL 1.2200E+03 101325.d0 3.1000E-10
  VISCOSITY CONSTANT 2.10000E-03
  ENTHALPY CONSTANT 1.8890d6
/

EOS GAS
  VISCOSITY CONSTANT 8.93389E-06
  HENRYS_CONSTANT CONSTANT 1.d10
/

TIMESTEPPER FLOW
  TS_ACCELERATION 10
  DT_FACTOR 2.d0 2.d0 1.8d0 1.6d0 1.4d0 1.2d0 1.d0 0.8d0 0.6d0 0.5d0
END

NEWTON_SOLVER FLOW
  RTOL 1.d-30
  ATOL 1.d-30
  STOL 1.d-30
  ITOL_RELATIVE_UPDATE 1.d-30
  MAXIT 20
END

!======== discretization ========
GRID
  TYPE structured
  NXYZ 5 1 3
  DXYZ
  5*10
  1*1
  3*1.32
  /
END

WIPP-CREEP_CLOSURE
  FILENAME pflotran_closure.dat
  MATERIAL M_WP
/

!======== regions & strata ========
REGION all
  COORDINATES
    -1.d20 -1.d20 -1.d20
     1.d20 1.d20 1.d20
  /
/

!======== boundary regions  ========

REGION R_WAS_AREA
  BLOCK 1 5 1 1 1 3
END

REGION west_boundary
  FACE WEST
  COORDINATES
    0.0000 0.0000 0.0000
    0.0000 1.0000 30.000
  /
/

REGION north_boundary
  FACE NORTH
  COORDINATES
    0.0000 1.0000 0.0000
    50.0000 1.0000 30.0000
  /
/

REGION east_boundary
  FACE EAST
  COORDINATES
    50.0000 0.0000 0.0000
    50.0000 1.0000 30.000
  /
/

REGION south_boundary
  FACE SOUTH
  COORDINATES
    0.0000 0.0000 0.0000
    50.000 0.0000 30.000
  /
/

REGION top_boundary
  FACE TOP
  COORDINATES
    0.00000 0.0000 30.0000
    50.0000 1.0000 30.0000
  /
/

REGION bottom_boundary
  FACE BOTTOM
  COORDINATES
    0.00000 0.0000 0.0000
    50.0000 1.0000 0.0000
  /
/

!======== materials  ========

MATERIAL_PROPERTY M_WP
  ID 1
  CHARACTERISTIC_CURVES CC_WP
  POROSITY  8.48000E-01
  TORTUOSITY 1.0
  ROCK_DENSITY 2163.0
  THERMAL_CONDUCTIVITY_DRY 5.4
  THERMAL_CONDUCTIVITY_WET 5.4
  SPECIFIC_HEAT 862.8d0
  SOIL_COMPRESSIBILITY_FUNCTION BRAGFLO
  SOIL_COMPRESSIBILITY 0.0
  SOIL_REFERENCE_PRESSURE 101325.d0
  PERMEABILITY
    PERM_ISO 2.39994E-13
  END
END

CHARACTERISTIC_CURVES CC_WP
  SATURATION_FUNCTION BROOKS_COREY
	MAX_CAPILLARY_PRESSURE 1.0D8
    ALPHA 9.869d-6
    LAMBDA 2.89000E+00
    LIQUID_RESIDUAL_SATURATION 5.50900E-01
  /
  PERMEABILITY_FUNCTION BURDINE
    LAMBDA 2.89000E+00
    LIQUID_RESIDUAL_SATURATION 5.50900E-01
  /
  PERMEABILITY_FUNCTION BURDINE_BC_GAS
    LAMBDA 2.89000E+00
    GAS_RESIDUAL_SATURATION 1.48400E-01
    LIQUID_RESIDUAL_SATURATION 5.50900E-01
  /
END

STRATA
	MATERIAL M_WP
	REGION R_WAS_AREA
END

!=========================== output options ===================================
skip
OUTPUT
!  PERIODIC_OBSERVATION TIMESTEP 1
  TIMES y 0.0 0.05 0.1 0.3 0.5 1.0 3.0 5.0 10.0 30.0 50.0 100.0 300.0 500.0 1000.0 3000.0 5000.0 10000.0
  FORMAT HDF5
  VARIABLES
    LIQUID_PRESSURE
    GAS_PRESSURE
    MINERAL_POROSITY
	EFFECTIVE_POROSITY
	LIQUID_DENSITY
	GAS_DENSITY
	LIQUID_SATURATION
	GAS_SATURATION
	GAS_MOLE_FRACTIONS
  /
/
noskip

!=========================== times ============================================
TIME
  FINAL_TIME 10000 y ! 0.317... y
  INITIAL_TIMESTEP_SIZE 1.00E+00 s
  MAXIMUM_TIMESTEP_SIZE 1000 y
/

REGION R_WAS_AREA_TOP
  BLOCK 1 5 1 1 3 3
END

REGION R_WAS_AREA_MID
  BLOCK 1 5 1 1 2 2
END

REGION R_WAS_AREA_BOT
  BLOCK 1 5 1 1 1 1
END

FLOW_CONDITION FC_WAS_AREA_TOP
  TYPE
    GAS_PRESSURE DIRICHLET
    LIQUID_SATURATION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.280390E+05
  LIQUID_SATURATION 6.500000e-02
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION FC_WAS_AREA_MID
  TYPE
    GAS_PRESSURE DIRICHLET
    LIQUID_SATURATION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.280390E+05
  LIQUID_SATURATION 6.500000e-02
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION FC_WAS_AREA_BOT
  TYPE
    GAS_PRESSURE DIRICHLET
    LIQUID_SATURATION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.280390E+05
  LIQUID_SATURATION 6.500000e-02
  TEMPERATURE 2.70000E+01
/

REGION injection_point
  BLOCK 1 5 1 1 1 3
/

SOURCE_SINK_SANDBOX
  WIPP-GAS_GENERATION
    REGION injection_point
    INUNDATED_CORROSION_RATE 1.0365E-08
    INUNDATED_DEGRADATION_RATE 1.6737E-09
    HUMID_CORROSION_FACTOR 0.0000E+00
    HUMID_DEGREDATION_FACTOR 6.5526E-01
    H2_FE_RATIO 1.0000E+00
    H2_CH2O_RATIO 4.9065E-01
  /
/

INITIAL_CONDITION
  FLOW_CONDITION FC_WAS_AREA_TOP
  REGION R_WAS_AREA_TOP
END

INITIAL_CONDITION
  FLOW_CONDITION FC_WAS_AREA_MID
  REGION R_WAS_AREA_MID
END

INITIAL_CONDITION
  FLOW_CONDITION FC_WAS_AREA_BOT
  REGION R_WAS_AREA_BOT
END

END_SUBSURFACE
