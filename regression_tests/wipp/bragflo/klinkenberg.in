! 9.6 Test Case #6-d. Klinkenberg Effect.
! Klinkenberg test case to compare against BRAGFLO.
! For more descriptions of the problem please read case_6-d.docx

!======== flow mode ========
SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
        MODE GENERAL
      OPTIONS
        ITOL_RELATIVE_UPDATE 1.d-30
        TWO_PHASE_ENERGY_DOF TEMPERATURE
        GAS_COMPONENT_FORMULA_WEIGHT 2.01588d0 ! kg/kmol
        MAXIMUM_PRESSURE_CHANGE 5.D4
        TOUGH2_ITOL_SCALED_RESIDUAL 1.d-5
        ISOTHERMAL
      /
    /
  /
END

SUBSURFACE

REGRESSION
  CELLS_PER_PROCESS 2
END

KLINKENBERG_EFFECT
  A 0.00d0 ! exponent
  B 1.75e+5
/

FLUID_PROPERTY
  PHASE LIQUID
  DIFFUSION_COEFFICIENT 0.0d0
END

FLUID_PROPERTY
  PHASE GAS
  DIFFUSION_COEFFICIENT 0.0d0
END
skip
EOS WATER
  DENSITY EXPONENTIAL 1.2200E+03 101325.d0 3.1000E-10
  VISCOSITY CONSTANT 2.10000E-03
  ENTHALPY CONSTANT 1.8890d6
/
noskip
EOS GAS
  VISCOSITY CONSTANT 8.93389E-06
!  HENRYS_CONSTANT CONSTANT 1.d10
/

NEWTON_SOLVER FLOW
  RTOL 1.d-30
  ATOL 1.d-30
  STOL 1.d-30
  MAXIT 20
END

!======== regions & strata ========
REGION all
  COORDINATES
    -1.d20 -1.d20 -1.d20
     1.d20 1.d20 1.d20
  /
/

!======== discretization ========
GRID
  TYPE structured
  NXYZ 10 1 1
  DXYZ
  1
  1
  1
  /
END

REGION INJ
  BLOCK 1 1 1 1 1 1
END

REGION R_WEST
  FACE WEST
  BLOCK 1 1 1 1 1 1
END

REGION R_EAST
  FACE EAST
  BLOCK 10 10 1 1 1 1
END

REGION BH
  BLOCK 1 10 1 1 1 1
END

STRATA
	MATERIAL M_BH
	REGION BH
END

skip
OUTPUT
!  PERIODIC_OBSERVATION TIMESTEP 1
  TIMES s 100 200 300 400 500 600 700 800 900 1000 \
          2000 3000 4000 5000 10000 20000 30000 40000 \
          50000 60000 70000 80000 86400
  FORMAT HDF5
  VARIABLES
    LIQUID_PRESSURE
    GAS_PRESSURE
    MINERAL_POROSITY
    EFFECTIVE_POROSITY
    LIQUID_DENSITY
    GAS_DENSITY
    LIQUID_SATURATION
    GAS_SATURATION
    GAS_MOLE_FRACTIONS
    PERMEABILITY_X
    PERMEABILITY_Y
    PERMEABILITY_Z
    MAXIMUM_PRESSURE
  /
/
noskip
!=========================== times ============================================
TIME
  FINAL_TIME 86400 s
  INITIAL_TIMESTEP_SIZE 1.00E-10 s
  MAXIMUM_TIMESTEP_SIZE 10000 s
/

MATERIAL_PROPERTY M_BH
  ID 1
  TORTUOSITY 1.d0
  POROSITY 3.0000d-01
  ROCK_DENSITY 999.d0
  THERMAL_CONDUCTIVITY_DRY 0.999d0
  THERMAL_CONDUCTIVITY_WET 0.999d0
  HEAT_CAPACITY 999.d0
  SOIL_COMPRESSIBILITY_FUNCTION BRAGFLO
  BULK_COMPRESSIBILITY 0.0d0
  SOIL_REFERENCE_PRESSURE 101325.d0
  CHARACTERISTIC_CURVES SF_BH_OPEN
  PERMEABILITY
    PERM_ISO_LOG10 -15.d0
  /
END

CHARACTERISTIC_CURVES SF_BH_OPEN
  SATURATION_FUNCTION LINEAR
    ALPHA  1.d30
    LIQUID_RESIDUAL_SATURATION 0.00000d+00
    MAX_CAPILLARY_PRESSURE 1.00000d+08
  /
  PERMEABILITY_FUNCTION BURDINE_LINEAR_LIQ
    LIQUID_RESIDUAL_SATURATION 0.00000d+00
  /
  PERMEABILITY_FUNCTION BURDINE_LINEAR_GAS
    LIQUID_RESIDUAL_SATURATION 0.00000d+00
    GAS_RESIDUAL_SATURATION    0.00000d+00
  /
END

FLOW_CONDITION FC_WEST
  TYPE
    GAS_PRESSURE DIRICHLET
    MOLE_FRACTION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.013250E+05
  MOLE_FRACTION 0.999999
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION FC_EAST
  TYPE
    GAS_PRESSURE DIRICHLET
    MOLE_FRACTION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.013250E+05
  MOLE_FRACTION 0.999999
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION FC_MIDDLE
  TYPE
    GAS_PRESSURE DIRICHLET
    MOLE_FRACTION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.013250E+05
  MOLE_FRACTION 0.999999
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION well  ! INJQ in BF
  TYPE
    RATE mass_rate
  /
  RATE 0.d0 1.d-6 0.d0 kg/s kg/s MW
/

INITIAL_CONDITION
  FLOW_CONDITION FC_MIDDLE
  REGION BH
END
skip
BOUNDARY_CONDITION
  FLOW_CONDITION FC_WEST
  REGION R_WEST
END
noskip
BOUNDARY_CONDITION
  FLOW_CONDITION FC_EAST
  REGION R_EAST
END

SOURCE_SINK well
  FLOW_CONDITION well
  REGION INJ
/

END_SUBSURFACE
