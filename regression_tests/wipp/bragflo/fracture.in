!======== flow mode ========
# File created by Heeho Park 4/17/15

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE GENERAL
      OPTIONS
        TWO_PHASE_ENERGY_DOF TEMPERATURE
        GAS_COMPONENT_FORMULA_WEIGHT 2.01588d0 ! kg/kmol
        MAXIMUM_PRESSURE_CHANGE 5.D3
        TOUGH2_ITOL_SCALED_RESIDUAL 1.d-5
        ISOTHERMAL
      /
    /
  /
END

SUBSURFACE

REGRESSION
  CELLS_PER_PROCESS 5
  CELLS
    9
  /
END

FLUID_PROPERTY
  PHASE LIQUID
  DIFFUSION_COEFFICIENT 0.0d0
END

FLUID_PROPERTY
  PHASE GAS
  DIFFUSION_COEFFICIENT 0.0d0
END

EOS WATER
  DENSITY EXPONENTIAL 1.2200E+03 101325.d0 3.1000E-10
  VISCOSITY CONSTANT 2.10000E-03
  ENTHALPY CONSTANT 1.8890d6
/

EOS GAS
  VISCOSITY CONSTANT 8.93389E-06
  HENRYS_CONSTANT CONSTANT 1.d10
/

NEWTON_SOLVER FLOW
  RTOL 1.d-30
  ATOL 1.d-30
  STOL 1.d-30
  ITOL_RELATIVE_UPDATE 1.d-30
  MAXIT 20
END

!======== discretization ========
GRID
  TYPE structured
  NXYZ 5 1 3 
  DXYZ
  5*10
  1*1
  3*1.32
  /
END

!======== regions & strata ========
REGION all
  COORDINATES
    -1.d20 -1.d20 -1.d20
     1.d20 1.d20 1.d20
  /
/

!======== boundary regions  ========

REGION R_MB138
  BLOCK 1 5 1 1 1 3
END 

REGION west_boundary
  FACE WEST
  COORDINATES
    0.0000 0.0000 0.0000
    0.0000 1.0000 30.000
  /
/

REGION north_boundary
  FACE NORTH
  COORDINATES
    0.0000 1.0000 0.0000
    50.0000 1.0000 30.0000
  /
/

REGION east_boundary
  FACE EAST
  COORDINATES
    50.0000 0.0000 0.0000
    50.0000 1.0000 30.000
  /
/

REGION south_boundary
  FACE SOUTH
  COORDINATES
    0.0000 0.0000 0.0000
    50.000 0.0000 30.000
  /
/

REGION top_boundary
  FACE TOP
  COORDINATES
    0.00000 0.0000 30.0000
    50.0000 1.0000 30.0000
  /
/

REGION bottom_boundary
  FACE BOTTOM
  COORDINATES
    0.00000 0.0000 0.0000
    50.0000 1.0000 0.0000
  /
/

!======== materials  ========

MATERIAL_PROPERTY S_MB138
  ID 1
  TORTUOSITY 1.d0
  POROSITY 1.10000d-02
  ROCK_DENSITY 999.d0
  THERMAL_CONDUCTIVITY_DRY 0.999d0
  THERMAL_CONDUCTIVITY_WET 0.999d0
  HEAT_CAPACITY 999.d0
  SOIL_COMPRESSIBILITY_FUNCTION BRAGFLO
  SOIL_COMPRESSIBILITY 8.263d-11
  SOIL_REFERENCE_PRESSURE 101325.d0
  CHARACTERISTIC_CURVES SF_MB138
  PERMEABILITY
    PERM_ISO_LOG10 -18.89d0
  /
  WIPP-FRACTURE
    INITIATING_PRESSURE 2.000000d+05
    ALTERED_PRESSURE 3.800000d+06
    MAXIMUM_FRACTURE_POROSITY 5.000000E-02
    FRACTURE_EXPONENT 1.576329E+01
    ALTER_PERM_X
    ALTER_PERM_Y
  /
END

CHARACTERISTIC_CURVES SF_MB138
  SATURATION_FUNCTION BROOKS_COREY
    SMOOTH
    LAMBDA 6.4360d-01
    ALPHA  1.0264d-06
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
    MAX_CAPILLARY_PRESSURE 1.00000d+08
  /
  PERMEABILITY_FUNCTION BURDINE_BC_LIQ
    LAMBDA 6.43600d-01
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
  /
  PERMEABILITY_FUNCTION BURDINE_BC_GAS
    LAMBDA 6.43600d-01
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
    GAS_RESIDUAL_SATURATION    7.71100d-02
  /
END

MATERIAL_PROPERTY S_MB139
  ID 2
  TORTUOSITY 1.d0
  POROSITY 1.10000d-02
  ROCK_DENSITY 999.d0
  THERMAL_CONDUCTIVITY_DRY 0.999d0
  THERMAL_CONDUCTIVITY_WET 0.999d0
  HEAT_CAPACITY 999.d0
  SOIL_COMPRESSIBILITY_FUNCTION BRAGFLO
  SOIL_COMPRESSIBILITY 8.263d-11
  SOIL_REFERENCE_PRESSURE 101325.d0
  CHARACTERISTIC_CURVES SF_MB138
  PERMEABILITY
    PERM_ISO_LOG10 -17.89d0
  /
END

CHARACTERISTIC_CURVES SF_MB139
  SATURATION_FUNCTION BROOKS_COREY
    SMOOTH
    LAMBDA 6.4360d-01
    ALPHA  1.0264d-06
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
    MAX_CAPILLARY_PRESSURE 1.00000d+08
  /
  PERMEABILITY_FUNCTION BURDINE_BC_LIQ
    LAMBDA 6.43600d-01
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
  /
  PERMEABILITY_FUNCTION BURDINE_BC_GAS
    LAMBDA 6.43600d-01
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
    GAS_RESIDUAL_SATURATION    7.71100d-02
  /
END

STRATA
	MATERIAL S_MB139
	REGION R_MB139_TOP
END

STRATA
	MATERIAL S_MB138
	REGION R_MB138_MID
END

STRATA
	MATERIAL S_MB139
	REGION R_MB139_BOT
END

!=========================== output options ===================================
OUTPUT
!  PERIODIC_OBSERVATION TIMESTEP 1
  TIMES y 0.0 0.05 0.1 0.3 0.5 1.0 3.0 5.0 10.0 30.0 50.0 100.0 300.0 500.0 1000.0 3000.0 5000.0 10000.0
  VARIABLES
    LIQUID_PRESSURE
    GAS_PRESSURE
    MINERAL_POROSITY
    EFFECTIVE_POROSITY
    LIQUID_DENSITY
    GAS_DENSITY
    LIQUID_SATURATION
    GAS_SATURATION
    GAS_MOLE_FRACTIONS
  /
/

!=========================== times ============================================
TIME
  FINAL_TIME 10000 y ! 0.317... y
  INITIAL_TIMESTEP_SIZE 1.00E+00 s
  MAXIMUM_TIMESTEP_SIZE 100 y
/

REGION R_MB139_TOP
  BLOCK 1 5 1 1 3 3
END 

REGION R_MB138_MID
  BLOCK 1 5 1 1 2 2
END

REGION R_MB139_BOT
  BLOCK 1 5 1 1 1 1
END

FLOW_CONDITION FC_MB139_TOP
  TYPE
    GAS_PRESSURE DIRICHLET
    LIQUID_SATURATION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.280390E+05
  LIQUID_SATURATION 1.500000e-02
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION FC_MB138_MID
  TYPE
    GAS_PRESSURE DIRICHLET
    LIQUID_SATURATION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.280390E+05
  LIQUID_SATURATION 1.500000e-02
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION FC_MB139_BOT
  TYPE
    GAS_PRESSURE DIRICHLET
    LIQUID_SATURATION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  GAS_PRESSURE 1.280390E+05
  LIQUID_SATURATION 1.500000e-02
  TEMPERATURE 2.70000E+01
/

REGION injection_point
  BLOCK 3 3 1 1 2 2 
/

SOURCE_SINK_SANDBOX
  WIPP-GAS_GENERATION
    REGION injection_point
    INUNDATED_CORROSION_RATE 1.0365E-08
    INUNDATED_DEGRADATION_RATE 1.6737E-09
    HUMID_CORROSION_FACTOR 0.0000E+00
    HUMID_DEGREDATION_FACTOR 6.5526E-01
    H2_FE_RATIO 1.0000E+00
    H2_CH2O_RATIO 4.9065E-01
  /
/


INITIAL_CONDITION
  FLOW_CONDITION FC_MB139_TOP
  REGION R_MB139_TOP
END

INITIAL_CONDITION
  FLOW_CONDITION FC_MB138_MID
  REGION R_MB138_MID
END

INITIAL_CONDITION
  FLOW_CONDITION FC_MB139_BOT
  REGION R_MB139_BOT
END

END_SUBSURFACE
