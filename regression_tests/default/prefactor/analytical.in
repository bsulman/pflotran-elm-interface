#Description: Crownpoint 5 Spot Uranium Leaching problem

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_TRANSPORT transport
      GLOBAL_IMPLICIT
#     NUMERICAL_JACOBIAN
      ITOL_RELATIVE_UPDATE 1.d-8
    /
  /
skip
  CHECKPOINT
    PERIODIC TIMESTEP 34
  /
noskip
#  RESTART analytical-ts34.chk
END

SUBSURFACE

#=========================== regression =======================================
REGRESSION
  CELLS_PER_PROCESS 4
  CELLS
    10
  /
END

UNIFORM_VELOCITY 1.d0 0.d0 0.d0 m/yr

#=========================== chemistry ========================================
EXTERNAL_FILE chemistry.txt


#=========================== solver options ===================================
TIMESTEPPER TRANSPORT
  TS_ACCELERATION 16
END

# == transport solvers ========================================================
NEWTON_SOLVER TRANSPORT
  ATOL 1.d-8
  RTOL 1.d-8
  STOL 1.d-30
  DTOL 1.d15
  ITOL 1.d-8
  MAXIT 25
END

#=========================== fluid properties =================================
FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9
END

#=========================== material properties ==============================
MATERIAL_PROPERTY NW
  ID 1
  POROSITY 0.20d0
  TORTUOSITY 1.d0
  PERMEABILITY
    PERM_X 0.64d-12
    PERM_Y 0.64d-12
    PERM_Z 0.64d-12
  /
  CHARACTERISTIC_CURVES default
END

MATERIAL_PROPERTY NE
  ID 2
  POROSITY 0.21d0
  TORTUOSITY 1.d0
  PERMEABILITY
    PERM_X 1.75d-12
    PERM_Y 1.75d-12
    PERM_Z 1.75d-12
  /
  CHARACTERISTIC_CURVES default
END

MATERIAL_PROPERTY SW
  ID 3
  POROSITY 0.16d0
  TORTUOSITY 1.d0
  PERMEABILITY
    PERM_X 0.75d-12
    PERM_Y 0.75d-12
    PERM_Z 0.75d-12
  /
  CHARACTERISTIC_CURVES default
END

MATERIAL_PROPERTY SE
  ID 4
  POROSITY 0.23d0
  TORTUOSITY 1.d0
  PERMEABILITY
    PERM_X 0.85d-12
    PERM_Y 0.85d-12
    PERM_Z 0.85d-12
  /
  CHARACTERISTIC_CURVES default
END


#=========================== characteristic curves ============================
CHARACTERISTIC_CURVES default
  DEFAULT
END

#=========================== output options ===================================
skip
OUTPUT
TIME_UNITS d
  TIMES d 0.001 0.01 0.1 0.25 0.5 0.75 1. 2. 3. 4. 5. 6. 7. 8. 9. 10. 15. 20. 25. 30. 35. 40. 45. 50. 60. \
  70. 80. 90. 100. 110. 120. 130. 140. 150. 175. 200. 225. 250. 275. 300. 325. 350. 360. 400. \
  450. 500. 550. 600. 650. 700. 750. 800. 850. 900. \
  950. 1000. 1050. 1100. 1150. 1200. 1250. 1500. 1750. 1825. 2000. 2500. 3000. 3500. 3650.
  PRINT_COLUMN_IDS
  PERIODIC_OBSERVATION TIMESTEP 1
  FORMAT TECPLOT POINT
  FORMAT HDF5 MULTIPLE_FILES
  VELOCITY_AT_CENTER
# SCREEN PERIODIC 10
  MASS_BALANCE DETAILED
END
noskip

OUTPUT
  FORMAT TECPLOT POINT
END

skip
OUTPUT
  MASS_BALANCE_FILE
    PERIODIC TIMESTEP 1
    DETAILED
  /
  SNAPSHOT_FILE
    TIMES d 0.001 0.01 0.1 0.25 0.5 0.75 1. 2. 3. 4. \
    5. 6. 7. 8. 9. 10. 15. 20. 25. 30. 35. 40. 45. 50. 60. \
    70. 80. 90. 100. 110. 120. 130. 140. 150. 175. 200. 225. 250. 275. 300. 325. 350. 360. 400. \
    450. 500. 550. 600. 650. 700. 750. 800. 850. 900. \
    950. 1000. 1050. 1100. 1150. 1200. 1250. 1500. 1750. 1825. 2000. 2500. 3000. 3500. 3650.
    FORMAT TECPLOT POINT
    FORMAT HDF5 MULTIPLE_FILES
  /
  OBSERVATION_FILE
    PERIODIC TIMESTEP 1
    PRINT_COLUMN_IDS
    VELOCITY
  /
END
noskip

#=========================== times ============================================
TIME
  FINAL_TIME 1.d0 d
  INITIAL_TIMESTEP_SIZE 1.d-8 d
  MAXIMUM_TIMESTEP_SIZE 1.e-2 d
END

#=========================== discretization ===================================
GRID
  TYPE STRUCTURED
  NXYZ 100 1 1
  BOUNDS
    0.0 0.0 0.0
    1.0 1.0 1.0
  /
END

#=========================== regions ==========================================
REGION all
  COORDINATES
     1.0 1.0 1.0
     0.0 0.0 0.0
  /
/

REGION east
  COORDINATES
     1.0 1.0 1.0
     1.0 0.0 0.0
  /
  FACE EAST
/
REGION west
  COORDINATES
     0.0 1.0 1.0
     0.0 0.0 0.0
  /
  FACE WEST
/

#=========================== condition couplers ===============================
INITIAL_CONDITION all
  TRANSPORT_CONDITION initial_ore
  REGION all
END

BOUNDARY_CONDITION inlet
  TRANSPORT_CONDITION inlet
  REGION west
END

BOUNDARY_CONDITION outlet
  TRANSPORT_CONDITION initial_ore
  REGION east
END

#=========================== flow conditions ==================================
#=========================== transport conditions =============================
TRANSPORT_CONDITION initial_ore
  TYPE DIRICHLET_ZERO_GRADIENT
  CONSTRAINT_LIST
    0.d0 initial_ore
  /
END

TRANSPORT_CONDITION inlet
  TYPE DIRICHLET
  CONSTRAINT_LIST
    0.d0 inlet0
  /
END

TRANSPORT_CONDITION outlet
  TYPE DIRICHLET_ZERO_GRADIENT
  CONSTRAINT_LIST
    0.d0 initial_ore
  /
END

#=========================== constraints ======================================
CONSTRAINT initial_ore
  CONCENTRATIONS
    Na+        4.34976e-3  Z
    Ca++       7.984d-5    M Calcite
    H+         8.3d0      pH
    UO2++      1.3503E-6   M Uraninite
    SiO2(aq)   8.15367e-4  M Coffinite
#   SiO2(aq)   8.15367e-4  M Quartz
    HCO3-      3.49082e-3  T
    Cl-        7.0798d-4   T
    O2(aq)     1.d-69      F
    Tracer     1.e-8       T
  /
  FREE_ION_GUESS
    Na+        4.8829E-03
    Ca++       1.8006E-01
    H+         8.2479E-07
    UO2++      1.3709E-15
    SiO2(aq)   1.8703E-04
    HCO3-      2.2687E-04
    Cl-        3.6763E-01
    O2(aq)     4.4614E-62
    Tracer     1.e-8
  /
  MINERALS
#   mineral       vol. frac. surface area
    Uraninite     0.000182352 3818.36 m^2/m^3
    Schoepite     0.d0      1.d0 cm^2/cm^3
    Coffinite     0.d0      1.d0 cm^2/cm^3
    Calcite       0.01d0    1.d0 cm^2/cm^3
    SiO2(am)      0.d0     10.d0 cm^2/cm^3
    Quartz        0.8d0     1.d0 cm^2/cm^3
  /
END

CONSTRAINT inlet0
  CONCENTRATIONS
    Na+        0.233314    Z
    Ca++       7.984d-5    M Calcite
    H+         8.3d0      pH
    UO2++      1.d-16      T 
    SiO2(aq)   8.15367e-4  T 
    HCO3-      0.233314    T
    Cl-        7.0798d-4   T
    O2(aq)     0.21        G O2(g)
    Tracer     1.e-0       T
  /
END

CONSTRAINT inlet1
  CONCENTRATIONS
    Na+        0.233314    Z
    Ca++       7.984d-5    M Calcite
    H+         8.3d0      pH
    UO2++      1.d-16      T 
    SiO2(aq)   8.15367e-4  T 
    HCO3-      0.233314    T
    Cl-        7.0798d-4   T
    O2(aq)     0.0587983   F
    Tracer     1.e-0       T
  /
END

#=========================== stratigraphy couplers ============================
STRATA
  REGION all
  MATERIAL NW
END

END_SUBSURFACE
