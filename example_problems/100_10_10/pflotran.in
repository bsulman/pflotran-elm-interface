:Description: 3D toy problem for richards equation
:
MODE RICHARDS
:MODE RICHARDS_LITE
TRAN 1
:UNIFORM_VELOCITY 1.d0 0.d0 0.d0
:NUMERICAL_JACOBIAN
:INEXACT_NEWTON
:
:DEBUG
:MATVIEW_JACOBIAN
:VECVIEW_RESIDUAL
:END
:
GRID
TYPE structured
NXYZ 100 10 10
END
:
ORIGIN 0.d0 0.d0 0.d0
:
NEWTON_SOLVER 
:NO_INFINITY_NORM
:NO_PRINT_CONVERGENCE
:PRINT_DETAILED_CONVERGENCE
END
:
!HDF5 !VELO FLUX
TECP !VELO FLUX
:
:    isync
COUP   0
:
DXYZ
1.d0
1.d0
1.d0
:
:  d0[m^2/s] delhaq[kJ/mol]
DIFF  1.D-9       12.6
:
: Richards Equation Pref
RICH 101325.
:
SATURATION_FUNCTIONS
:id itype swir   lambda alpha     pcwmax betac pwr
 1  1     0.1471 0.7465 4.4317d-4 1.e8   0.d0  1.d0
END

THERMAL_PROPERTIES
:ithm rho    cpr     ckdry cksat tau cdiff   cexp
  1   2.75e3 1000.e0 0.5   0.5   0.5 2.13d-5 1.8
END
:
MATERIALS
:name id icap ithm por  tau permx  permy  permz  permpwr
soil1 1  1    1    0.25 0.5 1.d-12 1.d-12 1.d-12 1.d0
END
:
:
TIME d every 10
100.d0
:
DTST 1.d-2
1. 10.d0
:
REGION all
BLOCK 1 100 1 10 1 10
END

REGION breakthrough
BLOCK 1 1 1 1 1 1
END

REGION West
BLOCK 1 1 1 10 1 10
FACE west
END

REGION East
BLOCK 100 100 1 10 1 10
FACE east
END

skip
BREAKTHROUGH 
REGION breakthrough
END
noskip

CONDITION west
CLASS flow
TYPE
PRESSURE hydrostatic
TEMPERATURE dirichlet
CONCENTRATION dirichlet
END
INTERPOLATION linear
DATUM 0.d0 0.d0 10.d0
PRESSURE 201325.d0
TEMPERATURE 25.d0 
CONCENTRATION 1.d0
END

CONDITION initial
CLASS flow
TYPE
PRESSURE hydrostatic
TEMPERATURE dirichlet
CONCENTRATION zero_gradient
END
INTERPOLATION linear
DATUM 0.d0 0.d0 10.d0
PRESSURE 101325.d0
TEMPERATURE 25.d0 
CONCENTRATION 1.d-6 
END

CONDITION west_c
CLASS transport
TYPE
CONCENTRATION dirichlet
END
CONCENTRATION 1.d0 
END

CONDITION initial_c
CLASS transport
TYPE
CONCENTRATION zero_gradient
END
CONCENTRATION 1.d-6 
END

CONDITION initial
CLASS transport
CONCENTRATION 1.d-6 
END

: initial condition
INITIAL_CONDITION
CONDITION initial
REGION all
END

: west boundary condition
BOUNDARY_CONDITION
CONDITION west
REGION West
END

: east boundary condition
BOUNDARY_CONDITION
CONDITION initial
REGION East
END

: initial condition
INITIAL_CONDITION
CONDITION initial_c
REGION all
END

: west boundary condition
BOUNDARY_CONDITION
CONDITION west_c
REGION West
END

: east boundary condition
BOUNDARY_CONDITION
CONDITION initial_c
REGION East
END

STRATA
REGION all
MATERIAL soil1
END

